(this.webpackJsonplpcenter=this.webpackJsonplpcenter||[]).push([[82],{1945:function(e,r,t){"use strict";t.r(r),t.d(r,"default",(function(){return J}));var i=t(1),n=t(19),o=t(1226),s=t(103),l=t(63),a=t(22),d=t(91),c=t(380),u=t(1241),p=t(226),b=t(159),m=t(225),j=t(1208),h=t(1255),v=t(1221),O=t(557),x=t(296),_=t(1236),f=t(1233),g=t(1229),y=t(1214),S=t(1232),w=t(1266),q=t(1204),C=t(1911),P=t(27),E=t(383),k=t.n(E),W=(t(192),t(384)),B=t.n(W),F=t(4),R=t(222),N=(t(381),t(1358)),A=t(1252),L=t(223),M=t(297),I=t(46),T=t(76),V=t(1240),D=t(0);Object(F.a)("div")((e=>{let{theme:r}=e;return{...r.typography.subtitle2,minWidth:160}}));function U(e){let{isEdit:r,currentSupervisor:t}=e;const o=Object(n.o)(),d=Object(s.c)(),{user:c}=Object(I.a)(),{enqueueSnackbar:u}=Object(b.b)(),{countries:E,city:W}=Object(s.d)((e=>e.user)),[F,U]=Object(i.useState)(!1),[J,z]=Object(i.useState)(!1),G=p.d().shape({username:p.e().min(3,"Too Short!").max(10,"Too Long!").required("username is required"),first_name:p.e().min(2,"Too Short!").max(50,"Too Long!").required("FirstName is required"),last_name:p.e().min(2,"Too Short!").max(50,"Too Long!").required("LastName is required"),c_percent:p.c().integer().required("Percent is required"),phone:p.c().integer().required("Phone number is required"),addresse_complet:p.e().required("Addresse complet is required"),country_id:p.e().required("Country is required"),city_id:p.e().required("City is required"),genre:p.e().required("Genre is required"),birth_date:p.b().required("birth date is required").nullable(),password:p.e().nullable().min(6,"Password should be of minimum 6 characters length")}),H=Object(m.c)({enableReinitialize:!0,initialValues:{username:(null===t||void 0===t?void 0:t.username)||null,phone:(null===t||void 0===t?void 0:t.phone)||null,first_name:(null===t||void 0===t?void 0:t.first_name)||null,last_name:(null===t||void 0===t?void 0:t.last_name)||null,birth_date:(null===t||void 0===t?void 0:t.birth_date)||null,c_percent:(null===t||void 0===t?void 0:t.c_percent)||null,addresse_complet:(null===t||void 0===t?void 0:t.addresse_complet)||null,country_id:(null===t||void 0===t?void 0:t.country)||null,city_id:(null===t||void 0===t?void 0:t.city)||null,genre:(null===t||void 0===t?void 0:t.genre)||null,user_photo:(null===t||void 0===t?void 0:t.user_photo)||null,password:null,block:null===t||void 0===t?void 0:t.block,is_owner:null===t||void 0===t?void 0:t.is_owner,supervisorId:null===t||void 0===t?void 0:t.id,perms:(null===t||void 0===t?void 0:t.perms)||[]},validationSchema:G,onSubmit:async(e,t)=>{let{setSubmitting:i,resetForm:n,setErrors:s}=t;const d=new FormData;d.append("username",e.username),!0===J&&d.append("user_photo",e.user_photo),d.append("first_name",e.first_name),d.append("last_name",e.last_name),d.append("phone",e.phone),d.append("birth_date",Object(L.a)(null===e||void 0===e?void 0:e.birth_date)),null!==e.password&&d.append("password",e.password),d.append("c_percent",e.c_percent),d.append("country_id",e.country_id),d.append("addresse_complet",e.addresse_complet),d.append("city_id",e.city_id),d.append("genre",e.genre),d.append("supervisorId",e.supervisorId),d.append("perms",JSON.stringify(null===e||void 0===e?void 0:e.perms.map((e=>e.codename)))),d.append("block",e.block?"True":"False"),d.append("is_owner",e.is_owner?"True":"False");try{var c;r?await R.a.handleModifySupervisor(d):await R.a.handleAddSupervisor(d),n(),i(!1),u(r?"Mettre \xe0 jour avec succ\xe8s":"Cr\xe9er avec succ\xe8s",{variant:"success"}),Object(l.F)(),o(null===(c=a.a.supervisor)||void 0===c?void 0:c.list)}catch(p){null!==p&&void 0!==p&&p.message?u(null===p||void 0===p?void 0:p.message,{variant:"error"}):alert(JSON.stringify(p)),i(!1),s(p)}}});Object(i.useEffect)((()=>{d(Object(l.F)()),d(Object(l.r)()),d(Object(l.o)())}),[d]);const{errors:K,values:Q,touched:X,handleSubmit:Y,isSubmitting:Z,setFieldValue:$,getFieldProps:ee}=H,[re,te]=i.useState((null===c||void 0===c?void 0:c.perms)||[]),ie=Object(i.useCallback)((e=>{const r=e[0];r&&$("user_photo",Object.assign(r,{preview:URL.createObjectURL(r)})),z(!0)}),[$]);return Object(D.jsx)(m.b,{value:H,children:Object(D.jsx)(m.a,{noValidate:!0,autoComplete:"off",onSubmit:Y,children:Object(D.jsx)(j.a,{container:!0,spacing:3,children:Object(D.jsx)(j.a,{item:!0,xs:12,md:12,children:Object(D.jsx)(h.a,{sx:{p:3},children:Object(D.jsxs)(v.a,{spacing:3,children:[Object(M.a)(null===c||void 0===c?void 0:c.perms,T.a.SUPERVISOR_OWNER)&&Object(D.jsx)(v.a,{children:Object(D.jsxs)(O.a,{sx:{mb:5},children:[Object(D.jsx)(A.a,{accept:"image/*",file:Q.user_photo,maxSize:3145728,onDrop:ie,error:Boolean(X.user_photo&&K.user_photo),caption:Object(D.jsxs)(x.a,{variant:"caption",sx:{mt:2,mx:"auto",display:"block",textAlign:"center",color:"text.secondary"},children:["Allowed *.jpeg, *.jpg, *.png",Object(D.jsx)("br",{})," max size of ",Object(V.b)(3145728)]})}),Object(D.jsx)(_.a,{error:!0,sx:{px:2,textAlign:"center"},children:X.user_photo&&K.user_photo})]})}),Object(D.jsxs)(v.a,{direction:{xs:"column",sm:"row"},spacing:{xs:3,sm:2},children:[Object(D.jsx)(f.a,{fullWidth:!0,label:"Pseudoname",placeholder:"Entrer le pseudoname",...ee("username"),error:Boolean(X.username&&K.username)}),Object(D.jsx)(f.a,{fullWidth:!0,label:"Num\xe9ro de t\xe9l\xe9phone",placeholder:"Entrer le num\xe9ro de t\xe9l\xe9phone",...ee("phone"),error:Boolean(X.phone&&K.phone)})]}),Object(D.jsxs)(v.a,{direction:{xs:"column",sm:"row"},spacing:{xs:3,sm:2},children:[Object(D.jsx)(f.a,{fullWidth:!0,label:"Pr\xe9nom",placeholder:"Entrer le pr\xe9nom",...ee("first_name"),error:Boolean(X.first_name&&K.first_name)}),Object(D.jsx)(f.a,{fullWidth:!0,label:"Nom de famille",placeholder:"Entrer le nom de famille",...ee("last_name"),error:Boolean(X.last_name&&K.last_name)})]}),Object(D.jsx)(v.a,{children:Object(D.jsx)(f.a,{fullWidth:!0,label:"Commission",placeholder:"Entrer le pourcentage",...ee("c_percent"),error:Boolean(X.c_percent&&K.c_percent)})}),Object(D.jsxs)(v.a,{direction:{xs:"column",sm:"row"},spacing:{xs:3,sm:2},children:[Object(D.jsxs)(f.a,{select:!0,fullWidth:!0,label:"Genre",placeholder:"Choisir le genre",...ee("genre"),SelectProps:{native:!0},error:Boolean(X.genre&&K.genre),children:[Object(D.jsx)("option",{value:""}),[{id:1,code_name:"M",name:"Male"},{id:2,code_name:"F",name:"Female"}].map((e=>Object(D.jsx)("option",{value:e.code_name,children:e.name},e.code_name)))]}),Object(D.jsx)(C.a,{label:"Date de naissance",placeholder:"Entrer la date de naissance",inputFormat:"yyyy-MM-dd",...ee("birth_date"),onChange:e=>$("birth_date",e),renderInput:e=>Object(D.jsx)(f.a,{fullWidth:!0,...e,error:Boolean(X.birth_date&&K.birth_date)})})]}),Boolean(X.birth_date&&K.birth_date)&&Object(D.jsx)(_.a,{sx:{px:2},error:!0,children:K.birth_date}),Object(D.jsxs)(v.a,{direction:{xs:"column",sm:"row"},spacing:{xs:3,sm:2},children:[Object(D.jsxs)(f.a,{select:!0,fullWidth:!0,label:"Pays",placeholder:"Choisir le Pays",...ee("country_id"),SelectProps:{native:!0},error:Boolean(X.country_id&&K.country_id),children:[Object(D.jsx)("option",{value:""}),null===E||void 0===E?void 0:E.map((e=>Object(D.jsx)("option",{value:e.id,children:e.name},e.id)))]}),Object(D.jsx)(f.a,{fullWidth:!0,label:"Ville",placeholder:"Choisir la ville",...ee("city_id"),error:Boolean(X.city_id&&K.city_id)})]}),Object(D.jsxs)(v.a,{direction:{xs:"column",sm:"row"},spacing:{xs:3,sm:2},children:[Object(D.jsx)(f.a,{fullWidth:!0,label:"Addresse complet",placeholder:"Entrer l'addresse complet",...ee("addresse_complet"),error:Boolean(X.addresse_complet&&K.addresse_complet)}),Object(D.jsx)(f.a,{disabled:!Object(M.a)(null===c||void 0===c?void 0:c.perms,T.a.CHANGE_PASSWORD_SUP),fullWidth:!0,autoComplete:"current-password",type:F?"text":"password",label:"Mot de passe",...ee("password"),InputProps:{endAdornment:Object(D.jsx)(g.a,{position:"end",children:Object(D.jsx)(y.a,{edge:"end",onClick:()=>U((e=>!e)),children:Object(D.jsx)(P.a,{icon:F?k.a:B.a})})})},error:Boolean(X.password&&K.password)})]}),Object(D.jsxs)(v.a,{direction:{xs:"column",md:"row"},spacing:2,children:[Object(D.jsx)(S.a,{control:Object(D.jsx)(w.a,{...ee("block"),checked:null===Q||void 0===Q?void 0:Q.block,color:null!==Q&&void 0!==Q&&Q.block?"success":"primary"}),labelPlacement:"start",label:"Block"}),Object(M.a)(null===c||void 0===c?void 0:c.perms,T.a.SUPERVISOR_OWNER)&&Object(D.jsx)(S.a,{control:Object(D.jsx)(w.a,{...ee("is_owner"),checked:null===Q||void 0===Q?void 0:Q.is_owner,color:null!==Q&&void 0!==Q&&Q.is_owner?"success":"primary"}),labelPlacement:"start",label:"Central Primaire"})]}),Object(D.jsx)(v.a,{children:Object(D.jsx)(N.a,{leftArr:re,right:Q.perms,setLeft:te,setRight:e=>{H.setFieldValue("perms",e)}})}),Object(D.jsx)(O.a,{sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:Object(D.jsx)(q.a,{type:"submit",variant:"contained",loading:Z,children:r?"Sauvegarder les modifications":"Cr\xe9er le superviseur"})})]})})})})})})}function J(){var e;const{themeStretch:r}=Object(d.a)(),t=Object(s.c)(),{pathname:p}=Object(n.m)(),{supervisorId:b}=Object(n.q)(),{supervisors:m}=Object(s.d)((e=>e.user)),j=p.includes("edit"),h=m.find((e=>(null===e||void 0===e?void 0:e.id)===Number(b))),[v,O]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{h&&O(!0)}),[h]),Object(i.useEffect)((()=>{t(Object(l.F)())}),[]),Object(D.jsx)(c.a,{title:"Superviseur: Cr\xe9er un nouvel superviseur | RLP Center Lotto",children:Object(D.jsxs)(o.a,{maxWidth:!r&&"lg",children:[Object(D.jsx)(u.a,{heading:j?"Modifier Superviseur":"Cr\xe9er un nouvel superviseur",links:[{name:"Dashboard",href:a.a.root},{name:"Superviseur",href:null===(e=a.a.supervisor)||void 0===e?void 0:e.root},{name:j?"Modification":"Nouvel superviseur"}]}),(!j||v)&&Object(D.jsx)(U,{isEdit:j,currentSupervisor:h})]})})}}}]);
//# sourceMappingURL=82.4e1c6643.chunk.js.map